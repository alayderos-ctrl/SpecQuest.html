<!DOCTYPE html>
<html lang="en">
<head>
<meta charset="UTF-8" />
<meta name="viewport" content="width=device-width, initial-scale=1.0"/>
<title>Scientists Matching Game</title>
<style>
  body {
    font-family: 'Segoe UI', Tahoma, Geneva, Verdana, sans-serif;
    background: linear-gradient(135deg, #1e1e2f, #2a2a3f);
    color: #fff;
    margin: 0;
    padding: 20px;
    display: flex;
    flex-direction: column;
    align-items: center;
    overflow: hidden; /* To contain particles */
  }
  h1 {
    text-shadow: 2px 2px 4px rgba(0,0,0,0.7);
    font-size: 2.5em;
    margin-bottom: 10px;
    position: relative;
    z-index: 1;
  }
  #score, #message, #timer {
    font-size: 1.3em;
    margin-top: 10px;
    text-shadow: 1px 1px 3px rgba(0,0,0,0.5);
    position: relative;
    z-index: 1;
  }
  #timer {
    font-weight: bold;
  }
  #game-container {
    display: flex;
    flex-wrap: wrap;
    justify-content: center;
    margin-top: 20px;
    max-width: 1200px;
    width: 100%;
    position: relative;
    z-index: 1;
  }
  /* Card styles with enhanced visuals */
  .card {
    width: 200px;
    height: 250px;
    margin: 10px;
    perspective: 1500px;
    cursor: pointer;
    box-shadow: 0 8px 16px rgba(0,0,0,0.3);
    border-radius: 12px;
    transition: transform 0.3s, box-shadow 0.3s;
    position: relative;
    z-index: 1;
  }
  .card:hover {
    transform: scale(1.05);
    box-shadow: 0 12px 24px rgba(0,0,0,0.4);
  }
  .card-inner {
    position: relative;
    width: 100%;
    height: 100%;
    text-align: center;
    transition: transform 0.8s;
    transform-style: preserve-3d;
    border-radius: 12px;
  }
  /* When flipped, rotate to show back */
  .card.flipped .card-inner {
    transform: rotateY(180deg);
  }
  /* Front side styles */
  .card-front {
    background: linear-gradient(145deg, #444, #222);
    display: flex;
    flex-direction: column; /* Stack image and name */
    align-items: center;
    justify-content: center;
    padding: 10px;
    box-shadow: inset 0 0 10px rgba(0,0,0,0.5);
    position: absolute;
    width: 100%;
    height: 100%;
    backface-visibility: hidden;
    border-radius: 12px;
  }

  /* Show the placeholder text on the front */
  .placeholder {
    font-size: 1.2em;
    padding: 20px;
    display: flex;
    align-items: center;
    justify-content: center;
    height: 100%;
  }

  /* Style for the name below the image */
  .scientist-name {
    margin-top: 10px; /* Adjust vertical position */
    font-weight: bold;
    font-size: 1.1em;
    text-align: center;
  }
  /* Back side styles */
  .card-back {
    background-color: #666;
    transform: rotateY(180deg);
    padding: 20px;
    box-sizing: border-box;
    display: flex;
    align-items: center;
    justify-content: center;
    font-size: 1em;
    line-height: 1.4;
    color: #fff;
    font-family: 'Arial Rounded MT Bold', 'Helvetica Rounded', Arial, sans-serif;
    position: absolute;
    width: 100%;
    height: 100%;
    backface-visibility: hidden;
    border-radius: 12px;
    flex-direction: column;
  }
  /* Style for the image on the back side */
  .card-back img {
    max-width: 180px;
    max-height: 180px;
    border-radius: 15px;
    box-shadow: 0 4px 8px rgba(0,0,0,0.3);
    margin-bottom: 15px;
  }

  /* Canvas for particles */
  #particle-canvas {
    position: fixed;
    top: 0;
    left: 0;
    width: 100%;
    height: 100%;
    z-index: 0; /* Behind all content */
    pointer-events: none; /* Allow clicks to pass through */
  }

  /* Overlay styles for countdown and instructions */
  #overlay {
    position: fixed;
    top:0; left:0; right:0; bottom:0;
    background: rgba(0,0,0,0.8);
    display: flex;
    flex-direction: column;
    align-items: center;
    justify-content: center;
    font-size: 3em;
    color: #fff;
    z-index: 9999;
    text-align: center;
  }
  #overlay.hidden {
    display: none;
  }
</style>
</head>
<body>

<!-- Canvas for floating particles -->
<canvas id="particle-canvas"></canvas>

<!-- Overlay for countdown and instructions -->
<div id="overlay">
  <div id="countdown"></div>
  <div id="instructions" style="font-size:1.5em; margin-top:20px;">Match each scientist with their description. Click to flip cards and find pairs!</div>
</div>

<h1>Scientists Matching Game</h1>
<div id="score">Score: 0</div>
<div id="message"></div>
<div id="timer">Time: 02:00</div>
<div id="game-container"></div>

<script>
// --- Part 1: Inherit score from URL ---
const passedScore = new URLSearchParams(window.location.search).get('score');
let score = 0;
if (passedScore !== null && !isNaN(parseInt(passedScore, 10))) {
  score = parseInt(passedScore, 10);
}
const scoreDisplay = document.getElementById('score');
scoreDisplay.textContent = 'Score: ' + score;

const scientists = [
  {
    name: "Andre-Marie Ampere",
    image: "https://i.pinimg.com/736x/87/77/3d/87773d96fa1e15d6e19aeed2434baccb.jpg",
    description: "Contributed in developing equations that showed the relationship of electricity and magnetism."
  },
  {
    name: "Michael Faraday",
    image: "https://i.pinimg.com/736x/67/f9/15/67f915a4d03bf750c86d799a08e913bc.jpg",
    description: "Showed experimental evidence of electromagnetic waves and their link to light."
  },
  {
    name: "Heinrich Hertz",
    image: "https://i.pinimg.com/736x/c3/79/85/c379855f48beb9565ef2c87e2318eda0.jpg",
    description: "Demonstrated the magnetic effect based on the direction of current."
  },
  {
    name: "James Clerk Maxwell",
    image: "https://i.pinimg.com/736x/2e/10/b6/2e10b6ab47b033c14fb394328d1290dd.jpg",
    description: "Formulated the principle behind electromagnetic induction."
  },
  {
    name: "Hans Christian Oersted",
    image: "https://i.pinimg.com/736x/73/17/d5/7317d58bfec25c057b54b5c81746e9c9.jpg",
    description: "Showed how a current carrying wire behaves like a magnet."
  }
];

const descriptions = [
  "Contributed in developing equations that showed the relationship of electricity and magnetism.",
  "Showed experimental evidence of electromagnetic waves and their link to light.",
  "Demonstrated the magnetic effect based on the direction of current.",
  "Formulated the principle behind electromagnetic induction.",
  "Showed how a current carrying wire behaves like a magnet."
];

// --- Part 2: Initialize game variables ---
let firstCard = null;
let secondCard = null;

const gameContainer = document.getElementById('game-container');
const messageDisplay = document.getElementById('message');
const timerDisplay = document.getElementById('timer');

let totalSeconds = 120; 
let timerInterval = null;

const overlay = document.getElementById('overlay');
const countdownEl = document.getElementById('countdown');

// --- Countdown from 3 ---
function startCountdown() {
  let count = 3;
  countdownEl.textContent = count;
  const countdownInterval = setInterval(() => {
    count--;
    if (count > 0) {
      countdownEl.textContent = count;
    } else {
      clearInterval(countdownInterval);
      overlay.classList.add('hidden');
      startGame();
    }
  }, 1000);
}

// --- Start the game after countdown ---
function startGame() {
  startTimer();
  createCards();
}

// --- Timer functions ---
function startTimer() {
  updateTimerDisplay();
  timerInterval = setInterval(() => {
    totalSeconds--;
    updateTimerDisplay();
    if (totalSeconds <= 0) {
      clearInterval(timerInterval);
      alert('Time is up! Game over.');
    }
  }, 1000);
}
function updateTimerDisplay() {
  const minutes = Math.floor(totalSeconds / 60);
  const seconds = totalSeconds % 60;
  document.getElementById('timer').textContent = `Time: ${minutes.toString().padStart(2, '0')}:${seconds.toString().padStart(2, '0')}`;
}

// --- Create cards ---
function createCards() {
  let cardsData = [];
  scientists.forEach((scientist, index) => {
    // Scientist card
    cardsData.push({
      id: 'scientist-' + index,
      type: 'scientist',
      content: scientist.name,
      associated: index
    });
    // Description card
    cardsData.push({
      id: 'desc-' + index,
      type: 'description',
      content: descriptions[index],
      associated: index
    });
  });
  // Shuffle
  cardsData = cardsData.sort(() => Math.random() - 0.5);

  // Generate DOM elements
  cardsData.forEach(cardData => {
    const card = document.createElement('div');
    card.className = 'card';
    card.dataset.id = cardData.id;
    card.dataset.type = cardData.type;
    card.dataset.associated = cardData.associated;

    const cardInner = document.createElement('div');
    cardInner.className = 'card-inner';

    const cardFront = document.createElement('div');
    cardFront.className = 'card-front';
    const placeholder = document.createElement('div');
    placeholder.className = 'placeholder';
    placeholder.innerHTML = '<strong>Match me!</strong>';
    cardFront.appendChild(placeholder);

    const cardBack = document.createElement('div');
    cardBack.className = 'card-back';
    if (cardData.type === 'scientist') {
      const img = document.createElement('img');
      img.src = scientists[cardData.associated].image;
      img.alt = scientists[cardData.associated].name;
      cardBack.appendChild(img);
    }
    cardBack.innerHTML += '<p>' + cardData.content + '</p>';

    cardInner.appendChild(cardFront);
    cardInner.appendChild(cardBack);
    card.appendChild(cardInner);

    // Flip logic
    card.addEventListener('click', () => {
      if (
        card.classList.contains('flipped') || 
        (firstCard && secondCard) || 
        (totalSeconds <= 0)
      ) {
        return;
      }
      card.classList.add('flipped');
      if (!firstCard) {
        firstCard = card;
      } else {
        secondCard = card;
        checkMatch();
      }
    });
    document.getElementById('game-container').appendChild(card);
  });
}

function checkMatch() {
  const isMatch = 
    firstCard.dataset.associated === secondCard.dataset.associated &&
    firstCard.dataset.type !== secondCard.dataset.type;
  if (isMatch) {
    score++;
    scoreDisplay.textContent = 'Score: ' + score;
    // Save score to URL
    const currentUrl = new URL(window.location.href);
    currentUrl.searchParams.set('score', score);
    window.history.replaceState({}, '', currentUrl.toString());

    document.getElementById('message').textContent = 'Correct Match!';
    firstCard = null;
    secondCard = null;

    // Check if all cards are matched
    if (document.querySelectorAll('.card:not(.flipped)').length === 0) {
      clearInterval(timerInterval);
      // Wait for a moment before redirecting
      setTimeout(() => {
        // Redirect to next level with score
        window.location.href = 'level13.html?score=' + score;
      }, 1000);
    }
  } else {
    document.getElementById('message').textContent = 'Try Again!';
    setTimeout(() => {
      firstCard.classList.remove('flipped');
      secondCard.classList.remove('flipped');
      firstCard = null;
      secondCard = null;
      document.getElementById('message').textContent = '';
    }, 1000);
  }
}

// --- Particles setup ---
const canvas = document.getElementById('particle-canvas');
const ctx = canvas.getContext('2d');

let particles = [];

function resizeCanvas() {
  canvas.width = window.innerWidth;
  canvas.height = window.innerHeight;
}
window.addEventListener('resize', resizeCanvas);
resizeCanvas();

class Particle {
  constructor() {
    this.reset();
  }
  reset() {
    this.x = Math.random() * window.innerWidth;
    this.y = Math.random() * window.innerHeight;
    this.vx = (Math.random() - 0.5) * 0.5;
    this.vy = (Math.random() - 0.5) * 0.5;
    this.size = Math.random() * 2 + 1;
    this.alpha = Math.random() * 0.5 + 0.5;
  }
  update() {
    this.x += this.vx;
    this.y += this.vy;
    if (this.x < 0 || this.x > window.innerWidth) {
      this.vx *= -1;
    }
    if (this.y < 0 || this.y > window.innerHeight) {
      this.vy *= -1;
    }
  }
  draw() {
    ctx.globalAlpha = this.alpha;
    ctx.fillStyle = '#fff';
    ctx.beginPath();
    ctx.arc(this.x, this.y, this.size, 0, Math.PI * 2);
    ctx.fill();
  }
}

for (let i = 0; i < 100; i++) {
  particles.push(new Particle());
}

function animate() {
  ctx.clearRect(0, 0, window.innerWidth, window.innerHeight);
  for (const p of particles) {
    p.update();
    p.draw();
  }
  requestAnimationFrame(animate);
}
animate();

// Kick off the countdown
startCountdown();

</script>
</body>
</html>
